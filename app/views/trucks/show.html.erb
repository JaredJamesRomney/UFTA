<div class="image-background" style="background-image: url('<%= @truck.main_image %>')"></div>

<div class="container">
	<h1 class="truck-title"><%= @truck.truck_name.capitalize %></h1>
	

	<p class="truck-info"><%= @truck.description %></p>

	<h1>Events:</h1>

	<p>
		<a class="btn btn-primary" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">Show/Hide Events</a>
	</p>

	<div class="collapse" id="collapseExample">
		<% unless @glocation.flatten.include?("#{@truck.truck_name}") %>
			<p class="alert alert-danger" role="alert">No upcoming Events</p>
		<% end %>

		<% @glocation.each do |info| %>
			<% if info[6] == @truck.truck_name %>
				<div class="row">
					<div class="col-md-11">
						<span><%= info[2] %>:</span>
						<p><%= info[3].to_date.strftime("%b. %d") %>, <%= info[3].strftime("%I:%M%p") %> - <%= info[4].to_date.strftime("%b. %d") %>, <%= info[4].strftime("%I:%M%p") %> <a href='https://maps.google.com/maps?q=<%= info[5] %>&hl=en' target='_blank'><%= info[5] %></a></p>
					</div>
					<div class="col-md-1 center">
						<%= link_to ("<i class='fa fa-times fa-2x' aria-hidden='true'></i>").html_safe, delete_event_path(id: @truck, event_id: info[7]), method: :delete, class: "text-danger", data: { confirm: 'Are you sure?' } if logged_in?(:admin) || (logged_in?(:truck) && current_user.id == @truck.user_id) %>
					</div>
				</div>
			<% end %>
		<% end %>
	</div>

	<h1>Menu:</h1>

	<% @truck.menus.each do |menu_item| %>
		<div class="card">
		<div class="row menu-item">
			<div class="col-md-3">
					<%= image_tag menu_item.food_image, width: '100%', class: "rounded float-right myImg", id: "myImg_#{menu_item.id}", alt: "#{menu_item.title.capitalize}", onclick: "reply_click(this.id)" %>
				<%#= image_tag "http://barcodedc.com/wp-content/gallery/food/healthfitnessrevolution-com.jpg", width: '100%', class: "rounded float-right myImg", id: "1", alt: "#{@truck.truck_name.capitalize}" %>

				<div id="myModal" class="modal">
				  <span class="close">&times;</span>
				  <img class="modal-content" id="img01">
				  <h1 id="caption"></h1>
				</div>

			</div>
			<div class="col-md-2 text-right menu-money my-auto">
				<h3><%= number_to_currency menu_item.price %></h3>
			</div>
			<div class="col-md-7 food-item my-auto">
				<h3><%= menu_item.title.capitalize %></h3>
				<p><%= menu_item.description %></p>
			</div>
		</div>
		</div>
	<% end %>

	<!-- <div class="row menu-item">
		<div class="col-md-3">
			<%#= image_tag menu_item.food_image, width: '100%' %>
			<%#= image_tag "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQjrD6kezgNgCwwCN18IHCiCpNfbEN8HJn9iFEq-NcUGdikFpDfbQ", width: '100%', class: "rounded float-right", id: "2", alt: "#{@truck.truck_name.capitalize}" %>
		</div>
		<div class="col-md-2 text-right menu-money my-auto">
			<h3><%#= number_to_currency "10" %></h3>
		</div>
		<div class="col-md-7 food-item my-auto">
			<h3>Food Item</h3>
			<p>description</p>
		</div>
	</div> -->

  
  <%= link_to 'Back', trucks_path %>
	<% if logged_in?(:admin) || (logged_in?(:truck) && current_user.id == @truck.user_id) %>
		|
    <%= link_to 'Edit', edit_truck_path(@truck), class: 'btn btn-warning' %> |
    <%= link_to 'Delete', truck_path(@truck), method: :delete, class: 'btn btn-danger', data: { confirm: 'Are you sure?' } %> |
    <%= link_to 'New Event', new_event_path(@truck), class: 'btn btn-primary' %>
  <% end %>
</div>


<script type="text/javascript">
	// Get the modal
	var modal = document.getElementById('myModal');

	// Get the image and insert it inside the modal - use its "alt" text as a caption

	function reply_click(clicked_id) {
		var img = document.getElementById(clicked_id);
		var modalImg = document.getElementById("img01");
		var captionText = document.getElementById("caption");
		
    modal.style.display = "block";
    modalImg.src = img.src;
    captionText.innerHTML = img.alt;
	}
	// Get the <span> element that closes the modal
	var span = document.getElementsByClassName("close")[0];

	// When the user clicks on <span> (x), close the modal
	span.onclick = function() { 
	    modal.style.display = "none";
	}
	// When the user clicks anywhere outside of the modal, close it
	window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
	}
</script>

